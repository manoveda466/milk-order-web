<div class="home-container">
  <!-- Common Loading Component -->
  <app-loading [overlay]="true"></app-loading>
  
  <!-- Left Sidebar Menu -->
  <div class="sidebar" [class.collapsed]="sidebarCollapsed">
    <div class="sidebar-header">
      <div class="logo-container" *ngIf="!sidebarCollapsed">
        <img src="images/milk.jpg" alt="Milk Order Logo" class="logo-image" (error)="onImageError($event)">
        <h3>Dashboard</h3>
      </div>
      <div class="logo-icon" *ngIf="sidebarCollapsed">
        <img src="images/milk.jpg" alt="Milk Order Logo" class="logo-icon-image">
      </div>
      <button class="toggle-btn" (click)="toggleSidebar()" 
              [matTooltip]="sidebarCollapsed ? 'Expand Sidebar' : 'Collapse Sidebar'"
              matTooltipPosition="right">
        <mat-icon>{{ sidebarCollapsed ? 'menu_open' : 'menu' }}</mat-icon>
      </button>
    </div>
    
    <nav class="sidebar-nav">
      <ul class="menu-list">
        <li *ngFor="let item of menuItems" 
            class="menu-item" 
            [class.active]="item.active"
            (click)="selectMenuItem(item.id)"
            [matTooltip]="sidebarCollapsed ? item.title : ''"
            matTooltipPosition="right">
          <mat-icon class="menu-icon">{{ item.icon }}</mat-icon>
          <span class="menu-title" *ngIf="!sidebarCollapsed">{{ item.title }}</span>
        </li>
      </ul>
    </nav>

     <div class="sidebar-footer">
      <button class="logout-btn" (click)="logout()" [matTooltip]="sidebarCollapsed ? 'Logout' : ''" matTooltipPosition="right">
        <mat-icon class="logout-icon">logout</mat-icon>
        <span *ngIf="!sidebarCollapsed">Logout</span>
      </button>
    </div> 
  </div>

  <!-- Main Content Area -->
  <div class="main-content">
    <div class="content-body">
      <!-- User Details Section -->
      <div *ngIf="activeSection === 'userDetails'" class="section user-details-section">
        <mat-card>
          <mat-card-header>
            <mat-card-title>Customer Information</mat-card-title>
            <mat-card-subtitle>Manage customer profile and personal details</mat-card-subtitle>
            <div class="header-actions">
              <button mat-raised-button color="primary" (click)="editUser(0)">
                <mat-icon>person_add</mat-icon>
                Add Customer
              </button>
              <button mat-raised-button color="accent" [matMenuTriggerFor]="exportMenu" 
                      matTooltip="Export customer data as PDF" style="margin-left: 8px;">
                <mat-icon>picture_as_pdf</mat-icon>
                Export PDF
                <mat-icon>arrow_drop_down</mat-icon>
              </button>
              <mat-menu #exportMenu="matMenu">
                <button mat-menu-item (click)="exportCustomersPDF('all')">
                  <mat-icon>people</mat-icon>
                  <span>Export All Customers</span>
                </button>
                <button mat-menu-item (click)="exportCustomersPDF('active')">
                  <mat-icon>people_outline</mat-icon>
                  <span>Export Active Only</span>
                </button>
                <button mat-menu-item (click)="exportCustomersPDF('inactive')">
                  <mat-icon>person_off</mat-icon>
                  <span>Export Inactive Only</span>
                </button>
              </mat-menu>
            </div>
          </mat-card-header>
          
          <mat-card-content>
            <!-- Customer Search Section -->
            <div class="customer-search-section">
              <mat-form-field appearance="outline" class="search-field">
                <mat-label>Search customers by name or mobile number...</mat-label>
                <input matInput 
                       [(ngModel)]="customerSearchText" 
                       (ngModelChange)="filterCustomers()"
                       placeholder="Type to search...">
                <mat-icon matSuffix>search</mat-icon>
              </mat-form-field>
              <button mat-raised-button 
                      color="primary" 
                      (click)="clearCustomerSearch()" 
                      class="clear-search-btn"
                      *ngIf="customerSearchText">
                <mat-icon>clear</mat-icon>
                Clear
              </button>
            </div>
            
            <div class="table-container">
              <mat-table [dataSource]="userDataSource" matSort class="mat-elevation-1">
                <ng-container matColumnDef="name">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Customer Name</mat-header-cell>
                  <mat-cell *matCellDef="let user">{{user.firstName +' '+ user.lastName}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="mobileNo">
                  <mat-header-cell *matHeaderCellDef>Mobile No</mat-header-cell>
                  <mat-cell *matCellDef="let user">{{user.mobile}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="area">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Area</mat-header-cell>
                  <mat-cell *matCellDef="let user">{{user.areaName}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="address">
                  <mat-header-cell *matHeaderCellDef>Address</mat-header-cell>
                  <mat-cell *matCellDef="let user" class="address-cell">{{user.address}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="pin">
                  <mat-header-cell *matHeaderCellDef>Login PIN</mat-header-cell>
                  <mat-cell *matCellDef="let user" class="pin-cell">{{user.pin}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="isActive">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Status</mat-header-cell>
                  <mat-cell *matCellDef="let user">
                    <span [class]="user.isActive ? 'status-badge status-active' : 'status-badge status-inactive'">
                      {{user.isActive ? 'Active' : 'Inactive'}}
                    </span>
                  </mat-cell>
                </ng-container>

                <ng-container matColumnDef="actions">
                  <mat-header-cell *matHeaderCellDef>Actions</mat-header-cell>
                  <mat-cell *matCellDef="let user">
                    <button mat-icon-button [matMenuTriggerFor]="userMenu">
                      <mat-icon>more_vert</mat-icon>
                    </button>
                    <mat-menu #userMenu="matMenu">
                      <button mat-menu-item (click)="editUser(user.userId)">
                        <mat-icon>edit</mat-icon>
                        <span>Edit</span>
                      </button>
                      <button mat-menu-item (click)="deactivateUser(user.userId)" *ngIf="user.isActive">
                        <mat-icon>block</mat-icon>
                        <span>Deactivate</span>
                      </button>
                      <button mat-menu-item (click)="activateUser(user.userId)" *ngIf="!user.isActive">
                        <mat-icon>check_circle</mat-icon>
                        <span>Activate</span>
                      </button>
                    </mat-menu>
                  </mat-cell>
                </ng-container>

                <mat-header-row *matHeaderRowDef="userDisplayedColumns"></mat-header-row>
                <mat-row *matRowDef="let row; columns: userDisplayedColumns;"></mat-row>
                <tr class="mat-row" *matNoDataRow>
                  <td class="mat-cell" [attr.colspan]="userDisplayedColumns.length">
                    <div class="no-data-message">
                      <mat-icon>info</mat-icon>
                      <span>No records available</span>
                    </div>
                  </td>
                </tr>
              </mat-table>
            </div>
          </mat-card-content>
        </mat-card>
      </div>

      <!-- Order Details Section -->
      <div *ngIf="activeSection === 'orderDetails'" class="section order-details-section">
        <mat-card>
          <mat-card-header>
            <mat-card-title>Order Management</mat-card-title>
            <mat-card-subtitle>Track and manage customer orders</mat-card-subtitle>
            <div class="header-actions">
              <button mat-raised-button color="primary" (click)="createManualOrder()" style="margin-right: 8px;">
                <mat-icon>add</mat-icon>
                Manual Order
              </button>
              <button mat-raised-button color="accent" (click)="exportOrdersPDF()" 
                      matTooltip="Export currently displayed orders as PDF">
                <mat-icon>picture_as_pdf</mat-icon>
                Export PDF
              </button>
            </div>
          </mat-card-header>
          
          <mat-card-content>
            <!-- Search and Filter Section -->
            <div class="search-filters">
              <div class="filter-row">
                <mat-form-field appearance="outline" class="filter-field">
                  <mat-label>Customer Name</mat-label>
                  <mat-select [(ngModel)]="orderFilters.customerName" (ngModelChange)="filterOrders()">
                    <mat-option value="">All Customers</mat-option>
                    <mat-option *ngFor="let customer of uniqueOrderCustomers" [value]="customer">{{customer}}</mat-option>
                  </mat-select>
                </mat-form-field>
                
                <mat-form-field appearance="outline" class="filter-field">
                  <mat-label>Delivery Date</mat-label>
                  <input matInput [matDatepicker]="picker" [(ngModel)]="orderFilters.deliveryDate" (ngModelChange)="filterOrders()">
                  <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                  <mat-datepicker #picker></mat-datepicker>
                </mat-form-field>
                
                <mat-form-field appearance="outline" class="filter-field">
                  <mat-label>Area</mat-label>
                  <mat-select [(ngModel)]="orderFilters.area" (ngModelChange)="filterOrders()">
                    <mat-option value="">All Areas</mat-option>
                    <mat-option *ngFor="let area of uniqueAreas" [value]="area">{{area}}</mat-option>
                  </mat-select>
                </mat-form-field>
                
                <mat-form-field appearance="outline" class="filter-field">
                  <mat-label>Status</mat-label>
                  <mat-select [(ngModel)]="orderFilters.status" (ngModelChange)="filterOrders()">
                    <mat-option value="">All Statuses</mat-option>
                    <mat-option *ngFor="let status of uniqueStatuses" [value]="status">{{status}}</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              
              <div class="filter-row">
                <mat-form-field appearance="outline" class="filter-field">
                  <mat-label>Token Type</mat-label>
                  <mat-select [(ngModel)]="orderFilters.tokenType" (ngModelChange)="filterOrders()">
                    <mat-option value="">All Token Types</mat-option>
                    <mat-option *ngFor="let tokenType of uniqueTokenTypes" [value]="tokenType">{{tokenType}}</mat-option>
                  </mat-select>
                </mat-form-field>
                
                <!-- Clear Filter Button -->
                <div class="filter-actions">
                  <button mat-raised-button color="primary" (click)="clearOrderFilters()" class="clear-btn" 
                          [disabled]="!isOrdersFiltered()">
                    <mat-icon>clear</mat-icon>
                    Clear Filters
                  </button>
                </div>
              </div>
            </div>
            
            <!-- Bulk Update Section -->
            <div class="bulk-update-section" *ngIf="getSelectedOrdersCount() > 0">
              <div class="bulk-update-info">
                <mat-icon>check_circle</mat-icon>
                <span><strong>{{getSelectedOrdersCount()}}</strong> {{ getSelectedOrdersCount() === 1 ? 'Order' : 'Orders' }} Selected</span>
              </div>
              <mat-form-field appearance="outline" class="bulk-status-field">
                <mat-label>Update Status</mat-label>
                <mat-select [(ngModel)]="bulkUpdateStatus">
                  <mat-option value="Delivered">Delivered</mat-option>
                  <mat-option value="Cancelled">Cancelled</mat-option>
                </mat-select>
              </mat-form-field>
              <button mat-raised-button color="accent" (click)="bulkUpdateOrderStatus()" [disabled]="!bulkUpdateStatus">
                <mat-icon>update</mat-icon>
                Update Selected
              </button>
            </div>
            
            <div class="table-container">
              <mat-table [dataSource]="orderDataSource" matSort class="mat-elevation-1">
                <ng-container matColumnDef="select">
                  <mat-header-cell *matHeaderCellDef>
                    <mat-checkbox 
                      [checked]="isAllOrdersSelected()"
                      [indeterminate]="getSelectedOrdersCount() > 0 && !isAllOrdersSelected()"
                      (change)="toggleAllOrders()">
                    </mat-checkbox>
                  </mat-header-cell>
                  <mat-cell *matCellDef="let order">
                    <mat-checkbox 
                      [checked]="isOrderSelected(order.orderId)"
                      [disabled]="order.status === 'Cancelled' || order.status === 'Delivered'"
                      (change)="toggleOrderSelection(order.orderId)">
                    </mat-checkbox>
                  </mat-cell>
                </ng-container>

                <ng-container matColumnDef="id">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Order ID</mat-header-cell>
                  <mat-cell *matCellDef="let order" class="order-id">#{{order.orderId}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="userName">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Customer Name</mat-header-cell>
                  <mat-cell *matCellDef="let order">{{order.userName}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="deliverDate">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Deliver Date</mat-header-cell>
                  <mat-cell *matCellDef="let order">{{order.orderDate | date:'dd-MMM-yyyy'}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="area">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Area</mat-header-cell>
                  <mat-cell *matCellDef="let order">{{order.areaName}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="tokenQty">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Token Qty</mat-header-cell>
                  <mat-cell *matCellDef="let order">{{order.tokenQty}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="tokenType">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Token Type</mat-header-cell>
                  <mat-cell *matCellDef="let order">{{order.tokenType}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="status">
                  <mat-header-cell *matHeaderCellDef>Status</mat-header-cell>
                  <mat-cell *matCellDef="let order">
                    <span [ngClass]="{
                      'status-badge': true,
                      'status-delivered': order.status === 'Delivered',
                      'status-confirmed': order.status === 'Confirmed',
                      'status-cancelled': order.status === 'Cancelled'
                    }">
                      {{order.status}}
                    </span>
                  </mat-cell>
                </ng-container>

                <ng-container matColumnDef="actions">
                  <mat-header-cell *matHeaderCellDef>Actions</mat-header-cell>
                  <mat-cell *matCellDef="let order">
                    <ng-container *ngIf="order.status !== 'Cancelled' && order.status !== 'Delivered'">
                      <button mat-icon-button [matMenuTriggerFor]="orderMenu">
                        <mat-icon>more_vert</mat-icon>
                      </button>
                      <mat-menu #orderMenu="matMenu">
                        <button mat-menu-item (click)="deliverOrder(order.orderId)" *ngIf="order.status !== 'Delivered'">
                          <mat-icon>local_shipping</mat-icon>
                          <span>Deliver Order</span>
                        </button>
                        <button mat-menu-item (click)="cancelOrder(order.orderId)" *ngIf="order.status !== 'Cancelled'">
                          <mat-icon>cancel</mat-icon>
                          <span>Cancel Order</span>
                        </button>
                      </mat-menu>
                    </ng-container>
                  </mat-cell>
                </ng-container>

                <mat-header-row *matHeaderRowDef="orderDisplayedColumns"></mat-header-row>
                <mat-row *matRowDef="let row; columns: orderDisplayedColumns;"></mat-row>
                <tr class="mat-row" *matNoDataRow>
                  <td class="mat-cell" [attr.colspan]="orderDisplayedColumns.length">
                    <div class="no-data-message">
                      <mat-icon>info</mat-icon>
                      <span>No records available</span>
                    </div>
                  </td>
                </tr>
              </mat-table>
            </div>
          </mat-card-content>
        </mat-card>
      </div>

      <!-- User Token Details Section -->
      <div *ngIf="activeSection === 'userTokenDetails'" class="section token-details-section">
        <mat-card>
          <mat-card-header>
            <mat-card-title>Token Management</mat-card-title>
            <mat-card-subtitle>Manage user tokens and subscriptions</mat-card-subtitle>
            <div class="header-actions">
              <button mat-raised-button color="primary" (click)="addToken()">
                <mat-icon>add</mat-icon>
                Add Token
              </button>
            </div>
          </mat-card-header>
          
          <mat-card-content>
            <!-- Search and Filter Section -->
            <div class="search-filters">
              <div class="filter-row">
                <mat-form-field appearance="outline" class="filter-field">
                  <mat-label>Customer Name</mat-label>
                  <mat-select [(ngModel)]="tokenHistoryFilters.customerName" (ngModelChange)="filterTokenHistory()">
                    <mat-option value="">All Customers</mat-option>
                    <mat-option *ngFor="let customerName of uniqueCustomerNames" [value]="customerName">{{customerName}}</mat-option>
                  </mat-select>
                </mat-form-field>

                <mat-form-field appearance="outline" class="filter-field">
                  <mat-label>Status</mat-label>
                  <mat-select [(ngModel)]="tokenHistoryFilters.status" (ngModelChange)="filterTokenHistory()">
                    <mat-option value="">All Status</mat-option>
                    <mat-option *ngFor="let status of uniqueTokenStatuses" [value]="status">{{status}}</mat-option>
                  </mat-select>
                </mat-form-field>

                <mat-form-field appearance="outline" class="filter-field">
                  <mat-label>Payment Mode</mat-label>
                  <mat-select [(ngModel)]="tokenHistoryFilters.paymentMode" (ngModelChange)="filterTokenHistory()">
                    <mat-option value="">All Payment Modes</mat-option>
                    <mat-option *ngFor="let mode of uniquePaymentModes" [value]="mode">{{mode}}</mat-option>
                  </mat-select>
                </mat-form-field>

                <mat-form-field appearance="outline" class="filter-field">
                  <mat-label>Payment Date</mat-label>
                  <input matInput [matDatepicker]="paymentDatePicker" [(ngModel)]="tokenHistoryFilters.paymentDate" (ngModelChange)="filterTokenHistory()">
                  <mat-datepicker-toggle matIconSuffix [for]="paymentDatePicker"></mat-datepicker-toggle>
                  <mat-datepicker #paymentDatePicker></mat-datepicker>
                </mat-form-field>
                
                <!-- Clear Filter Button -->
                <div class="filter-actions">
                  <button mat-raised-button color="primary" (click)="clearTokenHistoryFilters()" class="clear-btn"
                          [disabled]="!isTokenHistoryFiltered()">
                    <mat-icon>clear</mat-icon>
                    Clear Filters
                  </button>
                </div>
              </div>
            </div>
            
            <div class="table-container">
              <mat-table [dataSource]="tokenDataSource" matSort class="mat-elevation-1">
                <ng-container matColumnDef="name">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Customer Name</mat-header-cell>
                  <mat-cell *matCellDef="let token">{{token.userName}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="tokenQty">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Token Qty</mat-header-cell>
                  <mat-cell *matCellDef="let token">{{token.qty}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="issueDate">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Issue Date</mat-header-cell>
                  <mat-cell *matCellDef="let token">{{token.issueDate | date:'dd-MMM-yyyy'}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="tokenType">
                  <mat-header-cell *matHeaderCellDef>Token Type</mat-header-cell>
                  <mat-cell *matCellDef="let token">{{token.tokenType}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="totalAmount">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Total Amount</mat-header-cell>
                  <mat-cell *matCellDef="let token">{{token.totalAmount}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="paymentMode">
                  <mat-header-cell *matHeaderCellDef>Payment Mode</mat-header-cell>
                  <mat-cell *matCellDef="let token">{{token.paymentMode}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="paymentDate">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Payment Date</mat-header-cell>
                  <mat-cell *matCellDef="let token">{{token.paymentDate | date:'dd-MMM-yyyy'}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="status">
                  <mat-header-cell *matHeaderCellDef>Status</mat-header-cell>
                  <mat-cell *matCellDef="let token">
                    <span [ngClass]="{
                      'status-badge': true,
                      'status-completed': token.status && token.status.trim() === 'Completed',
                      'status-failed': token.status && token.status.trim() === 'Failed',
                      'status-paid': token.status && token.status.trim() && token.status.trim() !== 'Completed' && token.status.trim() !== 'Failed',
                      'status-unpaid': !token.status || !token.status.trim()
                    }">
                      <ng-container *ngIf="token.status && token.status.trim()">
                        {{token.status}}
                      </ng-container>
                      <ng-container *ngIf="!token.status || !token.status.trim()">
                        Not paid
                      </ng-container>
                    </span>
                  </mat-cell>
                </ng-container>

                <ng-container matColumnDef="actions">
                  <mat-header-cell *matHeaderCellDef>Actions</mat-header-cell>
                  <mat-cell *matCellDef="let token">
                    <ng-container *ngIf="!token.status || !token.status.trim()">
                      <button mat-icon-button [matMenuTriggerFor]="tokenMenu">
                        <mat-icon>more_vert</mat-icon>
                      </button>
                      <mat-menu #tokenMenu="matMenu">
                        <button mat-menu-item (click)="recordCashPayment(token.userTokenId)">
                          <mat-icon>payment</mat-icon>
                          <span>Cash Payment</span>
                        </button>
                        <button mat-menu-item (click)="deleteToken(token.userTokenId)">
                          <mat-icon>delete</mat-icon>
                          <span>Delete Token</span>
                        </button>
                      </mat-menu>
                    </ng-container>
                  </mat-cell>
                </ng-container>

                <mat-header-row *matHeaderRowDef="tokenDisplayedColumns"></mat-header-row>
                <mat-row *matRowDef="let row; columns: tokenDisplayedColumns;"></mat-row>
                <tr class="mat-row" *matNoDataRow>
                  <td class="mat-cell" [attr.colspan]="tokenDisplayedColumns.length">
                    <div class="no-data-message">
                      <mat-icon>info</mat-icon>
                      <span>No records available</span>
                    </div>
                  </td>
                </tr>
              </mat-table>
            </div>
          </mat-card-content>
        </mat-card>
      </div>

      <!-- Customer Token Balance Section -->
      <div *ngIf="activeSection === 'customerTokenBalance'" class="section token-balance-section">
        <mat-card>
          <mat-card-header>
            <mat-card-title>Customer Token Balance</mat-card-title>
            <mat-card-subtitle>View customer token balance information</mat-card-subtitle>
          </mat-card-header>
          
          <mat-card-content>
            <!-- Search and Filter Section -->
            <div class="search-filters">
              <div class="filter-row">
                <mat-form-field appearance="outline" class="filter-field">
                  <mat-label>Customer Name</mat-label>
                  <mat-select [(ngModel)]="tokenBalanceFilters.customerName" (ngModelChange)="filterTokenBalance()">
                    <mat-option value="">All Customers</mat-option>
                    <mat-option *ngFor="let customer of customerTokenBalance" [value]="customer.userName">{{customer.userName}}</mat-option>
                  </mat-select>
                </mat-form-field>
                
                <!-- Clear Filter Button -->
                <div class="filter-actions">
                  <button mat-raised-button color="primary" (click)="clearTokenBalanceFilters()" class="clear-btn"
                          [disabled]="!isTokenBalanceFiltered()">
                    <mat-icon>clear</mat-icon>
                    Clear Filters
                  </button>
                </div>
              </div>
            </div>
            
            <div class="table-container">
              <mat-table [dataSource]="tokenBalanceDataSource" matSort class="mat-elevation-1">
                <ng-container matColumnDef="customerName">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Customer Name</mat-header-cell>
                  <mat-cell *matCellDef="let customer">{{customer.userName}}</mat-cell>
                </ng-container>

                <ng-container matColumnDef="balanceTokenQty">
                  <mat-header-cell *matHeaderCellDef mat-sort-header>Total Token Balance</mat-header-cell>
                  <mat-cell *matCellDef="let customer" class="token-balance-cell">
                    <div class="token-breakdown-grid">
                      <span *ngFor="let token of customer.tokenDetails" class="token-balance-badge">
                        <span class="token-name">{{token.tokenType}}</span>
                        <span class="token-count">{{token.tokenQty}}</span>
                      </span>
                    </div>
                  </mat-cell>
                </ng-container>

                <mat-header-row *matHeaderRowDef="tokenBalanceDisplayedColumns"></mat-header-row>
                <mat-row *matRowDef="let row; columns: tokenBalanceDisplayedColumns;"></mat-row>
                <tr class="mat-row" *matNoDataRow>
                  <td class="mat-cell" [attr.colspan]="tokenBalanceDisplayedColumns.length">
                    <div class="no-data-message">
                      <mat-icon>info</mat-icon>
                      <span>No records available</span>
                    </div>
                  </td>
                </tr>
              </mat-table>
            </div>
          </mat-card-content>
        </mat-card>
      </div>


    </div>
  </div>
</div>
